# Universal Knowledge Assistant - Implementation Checklist
# December 15, 2025

## PATCH APPLICATION GUIDE

This document walks you through applying 4 major patches to transform your setup wizard from AetherMUD-specific to a configurable Universal Knowledge Assistant.

---

## FILES TO MODIFY (In Order)

### 1. config.yaml
**Location:** `E:\LLM-Universal Knowledge Assistant\universal-knowledge-assistant\config.yaml`

**Action:** REPLACE entire file with patch content

**What changed:**
- Removed AetherMUD references
- Added `paths:` section with 4 new config keys
- Changed assistant name to "Universal Knowledge Assistant"
- Made collection name "universal_knowledge"

**Time:** 2 minutes | **Difficulty:** ‚≠ê Easy

---

### 2. assistant_core.py
**Location:** `E:\LLM-Universal Knowledge Assistant\universal-knowledge-assistant\assistant_core.py`

**Action:** Apply 2 targeted code replacements

**What changed:**
- Updated `__init__` to accept configurable `codebase_path` and `config` dict
- Removed hardcoded "AetherMUD" from system prompt
- Now reads assistant name from config

**Time:** 5 minutes | **Difficulty:** ‚≠ê Easy

**Testing:** Python syntax check only (no functional test needed yet)

---

### 3. setup_wizard.py
**Location:** `E:\LLM-Universal Knowledge Assistant\universal-knowledge-assistant\setup_wizard.py`

**Action:** Apply 3 modifications + add 1 new method

**What changed:**
- Fixed `get_installed_models()` to deduplicate model list
- Updated `create_config()` to accept 4 new path parameters
- Added `resolve_paths()` method for default path handling
- Removed AetherMUD references

**Time:** 10 minutes | **Difficulty:** ‚≠ê‚≠ê Medium (careful with indentation)

**Key point:** The `create_config()` method signature CHANGES. Make sure all parameters are in correct order.

---

### 4. first_run_setup.pyw ‚ö†Ô∏è LARGEST CHANGES
**Location:** `E:\LLM-Universal Knowledge Assistant\universal-knowledge-assistant\first_run_setup.pyw`

**Action:** Major refactor - add new screen + new methods + modify existing screens

**What changed:**
- Added Screen 3: Path configuration with 3 folder pickers
- Renamed screens (new order: Welcome ‚Üí Dependencies ‚Üí **Paths** ‚Üí Configuration ‚Üí Finish)
- Added Launch checkbox + shortcut checkbox in Finish screen
- Fixed model deduplication in dropdown
- Updated all window titles (removed Thurtea branding)
- Rewrote `_create_finish_screen()` completely
- Added `_browse_folder()` helper method
- Added `_update_finish_summary()` method

**Time:** 25-30 minutes | **Difficulty:** ‚≠ê‚≠ê‚≠ê Complex (many interdependent changes)

**Strategy:** Apply changes in this order:
1. Add instance variables at top (lines ~90)
2. Update screen list (lines ~150-165)
3. Add new `_create_paths_screen()` method (after dependencies screen method)
4. Update existing screen titles (1 ‚Üí same, 2 ‚Üí same, 3‚Üínow "Step 4 of 5", 4‚Üí"Step 5 of 5")
5. Replace entire `_create_finish_screen()` method
6. Add new helper methods (`_browse_folder`, `_update_finish_summary`)
7. Update `_go_next()` logic for new screen count
8. Replace `_on_finish()` method
9. Update all title references (find & replace "Thurtea" mentions)

**Critical point:** This file has complex screen management - test thoroughly after changes!

---

## STEP-BY-STEP APPLICATION

### RECOMMENDED ORDER:

**Step 1: Backup original files**
```
Copy entire folder:
FROM: E:\LLM-Universal Knowledge Assistant\universal-knowledge-assistant
TO:   E:\LLM-Universal Knowledge Assistant\universal-knowledge-assistant.backup-pre-patch
```

**Step 2: Apply patches in this order:**
1. config.yaml (simplest, foundational)
2. assistant_core.py (quick, isolated)
3. setup_wizard.py (medium complexity)
4. first_run_setup.pyw (most complex)

**Step 3: Run quick syntax checks**
```
For each Python file, open in VS Code and check for:
- Red squiggly lines = syntax errors (fix before testing)
- Missing imports (look at top of files)
- Indentation issues (use Ctrl+Shift+P ‚Üí "Reindent" if needed)
```

**Step 4: Test the setup wizard**
```
Windows PowerShell:
cd E:\LLM-Universal Knowledge Assistant\universal-knowledge-assistant
python first_run_setup.pyw

Or double-click launch_setup.bat
```

**Step 5: Validate in GUI**
- [ ] Welcome screen displays "Universal Knowledge Assistant"
- [ ] Dependencies screen works (checks Ollama, packages, models)
- [ ] **NEW** Paths screen shows 3 folder inputs with Browse buttons
  - [ ] Models path defaults to C:\Users\<username>\.ollama\models
  - [ ] Database path defaults to ./chroma_db
  - [ ] Install dir shows current directory
  - [ ] All 3 "Browse" buttons work
- [ ] Configuration screen (model + name selection)
  - [ ] Model dropdown shows **no duplicates**
  - [ ] Name field accepts input
- [ ] Finish screen shows:
  - [ ] ‚òë Create desktop shortcut (checked by default)
  - [ ] ‚òë Launch application after installation (checked by default)
  - [ ] Summary shows all configuration values
- [ ] Clicking "Finish" creates config.yaml with new path values
- [ ] If "Launch" was checked, GUI should open after setup

---

## ERROR RECOVERY

If something breaks:

**Syntax errors after patching:**
1. Look at error message for line number
2. Check indentation (should be multiples of 4 spaces)
3. Compare to patch file - look for missing colons or brackets

**GUI doesn't launch:**
1. Check if python is in PATH: `python --version` in PowerShell
2. Check if dependencies installed: `pip list | grep customtkinter`
3. Look for error in PowerShell output

**Model deduplication still shows duplicates:**
1. Verify `get_installed_models()` has the `list(dict.fromkeys(models))` line
2. Check that dropdown is using this method's return value
3. In Chrome DevTools / Python debugger, print models list to see what's returned

**Paths not saving to config:**
1. Check config.yaml gets created in script directory
2. Verify `create_config()` is being called with correct parameters
3. Look for YAML syntax errors (colons, indentation)

---

## VALIDATION CHECKLIST AFTER PATCHING

### After applying all patches, verify:

**Code Quality:**
- [ ] No red/yellow squiggly lines in VS Code
- [ ] Python files load without import errors
- [ ] All window titles say "Universal Knowledge Assistant" (not AetherMUD)
- [ ] No hardcoded paths remain (except defaults in setup_wizard.py)

**Functionality:**
- [ ] Setup wizard runs without crashing
- [ ] Welcome screen appears with correct title
- [ ] 5 screens in order: Welcome ‚Üí Dependencies ‚Üí Paths ‚Üí Config ‚Üí Finish
- [ ] Can select folders with Browse buttons
- [ ] Model list has no duplicates
- [ ] Can select app name
- [ ] Finish screen has 2 checkboxes (shortcut + launch)
- [ ] Config.yaml created with paths section populated

**File System:**
- [ ] config.yaml exists with correct structure
- [ ] .setup_complete marker created
- [ ] Desktop shortcut created (if checked)
- [ ] GUI launches (if "Launch" was checked)

**Paths Configuration:**
- [ ] Ollama models path saved correctly
- [ ] Database path saved correctly
- [ ] Install directory saved correctly
- [ ] config.yaml readable and valid YAML format

---

## KNOWN ISSUES TO WATCH FOR

1. **Model Deduplication:**
   - If you see duplicate models in dropdown, check that Ollama API `/tags` endpoint isn't returning duplicates
   - Fallback: May need to deduplicate in UI layer too (already added in patch)

2. **Path Variables Not Persisting:**
   - Make sure `create_config()` is actually called in `_on_finish()`
   - Verify new path parameters are being passed

3. **Screen Navigation:**
   - If "Next" button doesn't advance, check that screen list is updated in `__init__`
   - Verify screen numbers in validation logic match new order

4. **Folder Browser:**
   - On Windows, `filedialog.askdirectory()` should work without issues
   - If not showing, verify `from tkinter import filedialog` is imported

---

## ROLLBACK PLAN

If you need to undo all changes:

```
Windows PowerShell:
Remove-Item E:\LLM-Universal Knowledge Assistant\universal-knowledge-assistant -Recurse
Move-Item E:\LLM-Universal Knowledge Assistant\universal-knowledge-assistant.backup-pre-patch `
  -Destination E:\LLM-Universal Knowledge Assistant\universal-knowledge-assistant
```

---

## WHAT'S NEXT AFTER VALIDATION

Once setup wizard is working:

1. **Update indexed_assistant.py** - remove AetherMUD references, use config collection name
2. **Update index_codebase.py** - use config paths for codebase location
3. **Update gui_assistant.py** - read app name from config, use configured database path
4. **Test full workflow:** Setup ‚Üí Create config ‚Üí Index codebase ‚Üí Launch GUI
5. **Create GitHub-ready repo:**
   - .gitignore (exclude chroma_db, __pycache__, .setup_complete)
   - README.md with setup instructions
   - LICENSE (MIT recommended)
   - CONTRIBUTING.md

---

## TIME ESTIMATE

- **config.yaml:** 2 min
- **assistant_core.py:** 5 min
- **setup_wizard.py:** 10 min
- **first_run_setup.pyw:** 30 min
- **Testing & validation:** 15 min
- **Total:** ~60 minutes

Start with config.yaml and assistant_core.py while you have momentum. Take a break before tackling first_run_setup.pyw (the big one).

---

Good luck! Let me know when you've applied the patches and are ready to test. üöÄ
